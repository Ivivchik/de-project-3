Убрал стейдж с сохранением файлов и сразу забираю из файлового хранилища с помощью "COPY table_name PROGRAM 'curl ...'".
При таком способе возникли трудности, вот мои шаги:
    1. Для этого способа, нужно что бы таблица была создана/
    2. Таблица создана, на первой итирации приходит csv без поля "status". Если таблица была создана без этого поля тогда все нормально при первом запуске.
        При втором запуске приходит поле "status", но в таргет таблице нет такого поля, а оно нам нужно.
    3. Если сразу создать таргет таблицу с полем "status", то все будет хорошо, за исключением запусков, когда csv будет приходить без этого поля
    4. При использование pandas метода, было все ок, так как он при отсутвие этого поля в таблицу заносил данные, а поля статус делал NULL
    5. В случае с COPY, пробовал создавать поле "status" с дефолтным значением, не помогло, ругался на то что в csv файле нет данных по этому полю
    6. Прочитал документацию(https://www.postgresql.org/docs/8.3/sql-copy.html), 
        "If a list of columns is specified, COPY will only copy the data in the specified columns to or from the file. If there are any columns in the table that are not in the column list, COPY FROM will insert the default values for those columns."
        То есть можно задать поля для COPY table_name(col1, col2, ...) FROM... 
        Если я перечислю все колонки без "status", то все будет работать и не падат, только status будет всегда значением по умолчанию, 
        если со "status", то он будет ругаться, что для данной колонки нет данных в файе
    И вот тут вопрос как правильно поступить, 
        1. использовать тот же пандас потому, что он нормально обрабатывает этот кейс?
        2. как-то можно использовать и COPY, только я плохо гуглил 
        3. использовать какой-то дргугой иструмент, например спрак, читать файлик, преобразовывать его в DF, смотреть схему, если есть в схеме статус, то все ок, если нет то добавлять эту колонку со значением по умолчанию или NULL
        4. Или как-то надо сделать вообще по другому, подскажите пожалуйста

Другой вопрос, вот есть такси для создания таблиц, их лучше делать в начале дага или перед тем как в них будут инсертится данные или же нет разницы ? 

И последний вопрос, возмем на примере функции get_report_id, на выходе мы можем получить report_id = None, и если это так то бы raise эксепшн делаем, а нужно ли перед этим делать логирования уровня error или выброса исключения с текстом будет достаточно? 

Заранее спасибо ) 


Вопросов больше нет) Спасибо за ревью!)